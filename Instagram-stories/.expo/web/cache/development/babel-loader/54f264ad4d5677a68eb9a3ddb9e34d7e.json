{"ast":null,"code":"import { canUseDOM } from 'fbjs/lib/ExecutionEnvironment';\nimport debounce from 'debounce';\nimport findNodeHandle from \"../../exports/findNodeHandle\";\nvar emptyObject = {};\nvar registry = {};\nvar id = 1;\n\nvar guid = function guid() {\n  return \"r-\" + id++;\n};\n\nvar resizeObserver;\n\nif (canUseDOM) {\n  if (typeof window.ResizeObserver !== 'undefined') {\n    resizeObserver = new window.ResizeObserver(function (entries) {\n      entries.forEach(function (_ref) {\n        var target = _ref.target;\n        var instance = registry[target._layoutId];\n        instance && instance._handleLayout();\n      });\n    });\n  } else {\n    if (process.env.NODE_ENV !== 'production' && process.env.NODE_ENV !== 'test') {\n      console.warn('onLayout relies on ResizeObserver which is not supported by your browser. ' + 'Please include a polyfill, e.g., https://github.com/que-etc/resize-observer-polyfill. ' + 'Falling back to window.onresize.');\n    }\n\n    var triggerAll = function triggerAll() {\n      Object.keys(registry).forEach(function (key) {\n        var instance = registry[key];\n\n        instance._handleLayout();\n      });\n    };\n\n    window.addEventListener('resize', debounce(triggerAll, 16), false);\n  }\n}\n\nvar observe = function observe(instance) {\n  var id = guid();\n  registry[id] = instance;\n\n  if (resizeObserver) {\n    var node = findNodeHandle(instance);\n\n    if (node) {\n      node._layoutId = id;\n      resizeObserver.observe(node);\n    }\n  } else {\n    instance._layoutId = id;\n\n    instance._handleLayout();\n  }\n};\n\nvar unobserve = function unobserve(instance) {\n  if (resizeObserver) {\n    var node = findNodeHandle(instance);\n\n    if (node) {\n      delete registry[node._layoutId];\n      delete node._layoutId;\n      resizeObserver.unobserve(node);\n    }\n  } else {\n    delete registry[instance._layoutId];\n    delete instance._layoutId;\n  }\n};\n\nvar safeOverride = function safeOverride(original, next) {\n  if (original) {\n    return function prototypeOverride() {\n      original.call(this, arguments);\n      next.call(this, arguments);\n    };\n  }\n\n  return next;\n};\n\nvar applyLayout = function applyLayout(Component) {\n  var componentDidMount = Component.prototype.componentDidMount;\n  var componentDidUpdate = Component.prototype.componentDidUpdate;\n  var componentWillUnmount = Component.prototype.componentWillUnmount;\n  Component.prototype.componentDidMount = safeOverride(componentDidMount, function componentDidMount() {\n    this._layoutState = emptyObject;\n    this._isMounted = true;\n\n    if (this.props.onLayout) {\n      observe(this);\n    }\n  });\n  Component.prototype.componentDidUpdate = safeOverride(componentDidUpdate, function componentDidUpdate(prevProps) {\n    if (this.props.onLayout && !prevProps.onLayout) {\n      observe(this);\n    } else if (!this.props.onLayout && prevProps.onLayout) {\n      unobserve(this);\n    }\n  });\n  Component.prototype.componentWillUnmount = safeOverride(componentWillUnmount, function componentWillUnmount() {\n    this._isMounted = false;\n\n    if (this.props.onLayout) {\n      unobserve(this);\n    }\n  });\n\n  Component.prototype._handleLayout = function () {\n    var _this = this;\n\n    var layout = this._layoutState;\n    var onLayout = this.props.onLayout;\n\n    if (onLayout) {\n      this.measure(function (x, y, width, height) {\n        if (_this._isMounted) {\n          if (layout.x !== x || layout.y !== y || layout.width !== width || layout.height !== height) {\n            _this._layoutState = {\n              x: x,\n              y: y,\n              width: width,\n              height: height\n            };\n            var nativeEvent = {\n              layout: _this._layoutState\n            };\n            Object.defineProperty(nativeEvent, 'target', {\n              enumerable: true,\n              get: function get() {\n                return findNodeHandle(_this);\n              }\n            });\n            onLayout({\n              nativeEvent: nativeEvent,\n              timeStamp: Date.now()\n            });\n          }\n        }\n      });\n    }\n  };\n\n  return Component;\n};\n\nexport default applyLayout;","map":{"version":3,"sources":["/home/swapnil/Downloads/Instagram-master (2)/node_modules/react-native-web/src/modules/applyLayout/index.js"],"names":["canUseDOM","debounce","findNodeHandle","emptyObject","registry","id","guid","resizeObserver","window","ResizeObserver","entries","forEach","target","instance","_layoutId","_handleLayout","process","env","NODE_ENV","console","warn","triggerAll","Object","keys","key","addEventListener","observe","node","unobserve","safeOverride","original","next","prototypeOverride","call","arguments","applyLayout","Component","componentDidMount","prototype","componentDidUpdate","componentWillUnmount","_layoutState","_isMounted","props","onLayout","prevProps","layout","measure","x","y","width","height","nativeEvent","defineProperty","enumerable","get","timeStamp","Date","now"],"mappings":"AASA,SAASA,SAAT,QAA0B,+BAA1B;AACA,OAAOC,QAAP,MAAqB,UAArB;AACA,OAAOC,cAAP;AAEA,IAAMC,WAAW,GAAG,EAApB;AACA,IAAMC,QAAQ,GAAG,EAAjB;AAEA,IAAIC,EAAE,GAAG,CAAT;;AACA,IAAMC,IAAI,GAAG,SAAPA,IAAO;AAAA,gBAAWD,EAAE,EAAb;AAAA,CAAb;;AAEA,IAAIE,cAAJ;;AACA,IAAIP,SAAJ,EAAe;AACb,MAAI,OAAOQ,MAAM,CAACC,cAAd,KAAiC,WAArC,EAAkD;AAChDF,IAAAA,cAAc,GAAG,IAAIC,MAAM,CAACC,cAAX,CAA0B,UAAAC,OAAO,EAAI;AACpDA,MAAAA,OAAO,CAACC,OAAR,CAAgB,gBAAgB;AAAA,YAAbC,MAAa,QAAbA,MAAa;AAC9B,YAAMC,QAAQ,GAAGT,QAAQ,CAACQ,MAAM,CAACE,SAAR,CAAzB;AACAD,QAAAA,QAAQ,IAAIA,QAAQ,CAACE,aAAT,EAAZ;AACD,OAHD;AAID,KALgB,CAAjB;AAMD,GAPD,MAOO;AACL,QAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,IAAyCF,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,MAAtE,EAA8E;AAC5EC,MAAAA,OAAO,CAACC,IAAR,CACE,+EACE,wFADF,GAEE,kCAHJ;AAKD;;AAED,QAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;AACvBC,MAAAA,MAAM,CAACC,IAAP,CAAYnB,QAAZ,EAAsBO,OAAtB,CAA8B,UAAAa,GAAG,EAAI;AACnC,YAAMX,QAAQ,GAAGT,QAAQ,CAACoB,GAAD,CAAzB;;AACAX,QAAAA,QAAQ,CAACE,aAAT;AACD,OAHD;AAID,KALD;;AAOAP,IAAAA,MAAM,CAACiB,gBAAP,CAAwB,QAAxB,EAAkCxB,QAAQ,CAACoB,UAAD,EAAa,EAAb,CAA1C,EAA4D,KAA5D;AACD;AACF;;AAED,IAAMK,OAAO,GAAG,SAAVA,OAAU,CAAAb,QAAQ,EAAI;AAC1B,MAAMR,EAAE,GAAGC,IAAI,EAAf;AACAF,EAAAA,QAAQ,CAACC,EAAD,CAAR,GAAeQ,QAAf;;AAEA,MAAIN,cAAJ,EAAoB;AAClB,QAAMoB,IAAI,GAAGzB,cAAc,CAACW,QAAD,CAA3B;;AACA,QAAIc,IAAJ,EAAU;AACRA,MAAAA,IAAI,CAACb,SAAL,GAAiBT,EAAjB;AACAE,MAAAA,cAAc,CAACmB,OAAf,CAAuBC,IAAvB;AACD;AACF,GAND,MAMO;AACLd,IAAAA,QAAQ,CAACC,SAAT,GAAqBT,EAArB;;AACAQ,IAAAA,QAAQ,CAACE,aAAT;AACD;AACF,CAdD;;AAgBA,IAAMa,SAAS,GAAG,SAAZA,SAAY,CAAAf,QAAQ,EAAI;AAC5B,MAAIN,cAAJ,EAAoB;AAClB,QAAMoB,IAAI,GAAGzB,cAAc,CAACW,QAAD,CAA3B;;AACA,QAAIc,IAAJ,EAAU;AACR,aAAOvB,QAAQ,CAACuB,IAAI,CAACb,SAAN,CAAf;AACA,aAAOa,IAAI,CAACb,SAAZ;AACAP,MAAAA,cAAc,CAACqB,SAAf,CAAyBD,IAAzB;AACD;AACF,GAPD,MAOO;AACL,WAAOvB,QAAQ,CAACS,QAAQ,CAACC,SAAV,CAAf;AACA,WAAOD,QAAQ,CAACC,SAAhB;AACD;AACF,CAZD;;AAcA,IAAMe,YAAY,GAAG,SAAfA,YAAe,CAACC,QAAD,EAAWC,IAAX,EAAoB;AACvC,MAAID,QAAJ,EAAc;AACZ,WAAO,SAASE,iBAAT,GAA6B;AAElCF,MAAAA,QAAQ,CAACG,IAAT,CAAc,IAAd,EAAoBC,SAApB;AACAH,MAAAA,IAAI,CAACE,IAAL,CAAU,IAAV,EAAgBC,SAAhB;AAED,KALD;AAMD;;AACD,SAAOH,IAAP;AACD,CAVD;;AAYA,IAAMI,WAAW,GAAG,SAAdA,WAAc,CAAAC,SAAS,EAAI;AAC/B,MAAMC,iBAAiB,GAAGD,SAAS,CAACE,SAAV,CAAoBD,iBAA9C;AACA,MAAME,kBAAkB,GAAGH,SAAS,CAACE,SAAV,CAAoBC,kBAA/C;AACA,MAAMC,oBAAoB,GAAGJ,SAAS,CAACE,SAAV,CAAoBE,oBAAjD;AAEAJ,EAAAA,SAAS,CAACE,SAAV,CAAoBD,iBAApB,GAAwCR,YAAY,CAClDQ,iBADkD,EAElD,SAASA,iBAAT,GAA6B;AAC3B,SAAKI,YAAL,GAAoBtC,WAApB;AACA,SAAKuC,UAAL,GAAkB,IAAlB;;AACA,QAAI,KAAKC,KAAL,CAAWC,QAAf,EAAyB;AACvBlB,MAAAA,OAAO,CAAC,IAAD,CAAP;AACD;AACF,GARiD,CAApD;AAWAU,EAAAA,SAAS,CAACE,SAAV,CAAoBC,kBAApB,GAAyCV,YAAY,CACnDU,kBADmD,EAEnD,SAASA,kBAAT,CAA4BM,SAA5B,EAAuC;AACrC,QAAI,KAAKF,KAAL,CAAWC,QAAX,IAAuB,CAACC,SAAS,CAACD,QAAtC,EAAgD;AAC9ClB,MAAAA,OAAO,CAAC,IAAD,CAAP;AACD,KAFD,MAEO,IAAI,CAAC,KAAKiB,KAAL,CAAWC,QAAZ,IAAwBC,SAAS,CAACD,QAAtC,EAAgD;AACrDhB,MAAAA,SAAS,CAAC,IAAD,CAAT;AACD;AACF,GARkD,CAArD;AAWAQ,EAAAA,SAAS,CAACE,SAAV,CAAoBE,oBAApB,GAA2CX,YAAY,CACrDW,oBADqD,EAErD,SAASA,oBAAT,GAAgC;AAC9B,SAAKE,UAAL,GAAkB,KAAlB;;AACA,QAAI,KAAKC,KAAL,CAAWC,QAAf,EAAyB;AACvBhB,MAAAA,SAAS,CAAC,IAAD,CAAT;AACD;AACF,GAPoD,CAAvD;;AAUAQ,EAAAA,SAAS,CAACE,SAAV,CAAoBvB,aAApB,GAAoC,YAAW;AAAA;;AAC7C,QAAM+B,MAAM,GAAG,KAAKL,YAApB;AAD6C,QAErCG,QAFqC,GAExB,KAAKD,KAFmB,CAErCC,QAFqC;;AAI7C,QAAIA,QAAJ,EAAc;AACZ,WAAKG,OAAL,CAAa,UAACC,CAAD,EAAIC,CAAJ,EAAOC,KAAP,EAAcC,MAAd,EAAyB;AACpC,YAAI,KAAI,CAACT,UAAT,EAAqB;AACnB,cACEI,MAAM,CAACE,CAAP,KAAaA,CAAb,IACAF,MAAM,CAACG,CAAP,KAAaA,CADb,IAEAH,MAAM,CAACI,KAAP,KAAiBA,KAFjB,IAGAJ,MAAM,CAACK,MAAP,KAAkBA,MAJpB,EAKE;AACA,YAAA,KAAI,CAACV,YAAL,GAAoB;AAAEO,cAAAA,CAAC,EAADA,CAAF;AAAKC,cAAAA,CAAC,EAADA,CAAL;AAAQC,cAAAA,KAAK,EAALA,KAAR;AAAeC,cAAAA,MAAM,EAANA;AAAf,aAApB;AACA,gBAAMC,WAAW,GAAG;AAClBN,cAAAA,MAAM,EAAE,KAAI,CAACL;AADK,aAApB;AAGAnB,YAAAA,MAAM,CAAC+B,cAAP,CAAsBD,WAAtB,EAAmC,QAAnC,EAA6C;AAC3CE,cAAAA,UAAU,EAAE,IAD+B;AAE3CC,cAAAA,GAAG,EAAE;AAAA,uBAAMrD,cAAc,CAAC,KAAD,CAApB;AAAA;AAFsC,aAA7C;AAIA0C,YAAAA,QAAQ,CAAC;AAAEQ,cAAAA,WAAW,EAAXA,WAAF;AAAeI,cAAAA,SAAS,EAAEC,IAAI,CAACC,GAAL;AAA1B,aAAD,CAAR;AACD;AACF;AACF,OAnBD;AAoBD;AACF,GA1BD;;AA2BA,SAAOtB,SAAP;AACD,CAjED;;AAmEA,eAAeD,WAAf","sourcesContent":["/**\n * Copyright (c) Nicolas Gallagher.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @noflow\n */\n\nimport { canUseDOM } from 'fbjs/lib/ExecutionEnvironment';\nimport debounce from 'debounce';\nimport findNodeHandle from '../../exports/findNodeHandle';\n\nconst emptyObject = {};\nconst registry = {};\n\nlet id = 1;\nconst guid = () => `r-${id++}`;\n\nlet resizeObserver;\nif (canUseDOM) {\n  if (typeof window.ResizeObserver !== 'undefined') {\n    resizeObserver = new window.ResizeObserver(entries => {\n      entries.forEach(({ target }) => {\n        const instance = registry[target._layoutId];\n        instance && instance._handleLayout();\n      });\n    });\n  } else {\n    if (process.env.NODE_ENV !== 'production' && process.env.NODE_ENV !== 'test') {\n      console.warn(\n        'onLayout relies on ResizeObserver which is not supported by your browser. ' +\n          'Please include a polyfill, e.g., https://github.com/que-etc/resize-observer-polyfill. ' +\n          'Falling back to window.onresize.'\n      );\n    }\n\n    const triggerAll = () => {\n      Object.keys(registry).forEach(key => {\n        const instance = registry[key];\n        instance._handleLayout();\n      });\n    };\n\n    window.addEventListener('resize', debounce(triggerAll, 16), false);\n  }\n}\n\nconst observe = instance => {\n  const id = guid();\n  registry[id] = instance;\n\n  if (resizeObserver) {\n    const node = findNodeHandle(instance);\n    if (node) {\n      node._layoutId = id;\n      resizeObserver.observe(node);\n    }\n  } else {\n    instance._layoutId = id;\n    instance._handleLayout();\n  }\n};\n\nconst unobserve = instance => {\n  if (resizeObserver) {\n    const node = findNodeHandle(instance);\n    if (node) {\n      delete registry[node._layoutId];\n      delete node._layoutId;\n      resizeObserver.unobserve(node);\n    }\n  } else {\n    delete registry[instance._layoutId];\n    delete instance._layoutId;\n  }\n};\n\nconst safeOverride = (original, next) => {\n  if (original) {\n    return function prototypeOverride() {\n      /* eslint-disable prefer-rest-params */\n      original.call(this, arguments);\n      next.call(this, arguments);\n      /* eslint-enable prefer-rest-params */\n    };\n  }\n  return next;\n};\n\nconst applyLayout = Component => {\n  const componentDidMount = Component.prototype.componentDidMount;\n  const componentDidUpdate = Component.prototype.componentDidUpdate;\n  const componentWillUnmount = Component.prototype.componentWillUnmount;\n\n  Component.prototype.componentDidMount = safeOverride(\n    componentDidMount,\n    function componentDidMount() {\n      this._layoutState = emptyObject;\n      this._isMounted = true;\n      if (this.props.onLayout) {\n        observe(this);\n      }\n    }\n  );\n\n  Component.prototype.componentDidUpdate = safeOverride(\n    componentDidUpdate,\n    function componentDidUpdate(prevProps) {\n      if (this.props.onLayout && !prevProps.onLayout) {\n        observe(this);\n      } else if (!this.props.onLayout && prevProps.onLayout) {\n        unobserve(this);\n      }\n    }\n  );\n\n  Component.prototype.componentWillUnmount = safeOverride(\n    componentWillUnmount,\n    function componentWillUnmount() {\n      this._isMounted = false;\n      if (this.props.onLayout) {\n        unobserve(this);\n      }\n    }\n  );\n\n  Component.prototype._handleLayout = function() {\n    const layout = this._layoutState;\n    const { onLayout } = this.props;\n\n    if (onLayout) {\n      this.measure((x, y, width, height) => {\n        if (this._isMounted) {\n          if (\n            layout.x !== x ||\n            layout.y !== y ||\n            layout.width !== width ||\n            layout.height !== height\n          ) {\n            this._layoutState = { x, y, width, height };\n            const nativeEvent = {\n              layout: this._layoutState\n            };\n            Object.defineProperty(nativeEvent, 'target', {\n              enumerable: true,\n              get: () => findNodeHandle(this)\n            });\n            onLayout({ nativeEvent, timeStamp: Date.now() });\n          }\n        }\n      });\n    }\n  };\n  return Component;\n};\n\nexport default applyLayout;\n"]},"metadata":{},"sourceType":"module"}